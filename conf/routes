# Routes
# This file defines all application routes (Higher priority routes first)


# IMPORTANT: Comments appended to a valid line are not permitted\
# IMPORTANT: Controllers are now injected, do not forget the '@' prefix
# ~~~~

############################################################################
# Toolkit related routes
############################################################################

# Index Page requested by user. Note that the controller is injected
GET           /                                       @controllers.Application.index()

# Dashboard for Admin

POST          /settings/clustermode                   @controllers.Settings.setClusterMode(clusterMode : String)
POST          /settings/memset                        @controllers.Settings.setMemoryAllocation(memory: Int, toolName: String)

GET           /@/backend/settings                     @controllers.Backend.settings
GET           /@/backend/edit                         @controllers.Backend.edit
GET           /@/backend/access                       @controllers.Backend.access
GET           /@/backend/logout                       @controllers.Backend.logOut

# integrated mithril route backend routes
GET           /backend/index                          @controllers.Backend.index
GET           /backend/statistics                     @controllers.Backend.statistics
GET           /backend/pushMonthlyStatistics          @controllers.Backend.pushMonthlyStatistics
GET           /backend/cms                            @controllers.Backend.cms
POST          /backend/cms                            @controllers.Backend.cms
GET           /backend/users                          @controllers.Backend.users
POST          /backend/users                          @controllers.Backend.users

# Websocket
GET           /ws                                     @controllers.Application.ws


# Serve files
GET           /files/:mainID/:filename                @controllers.Application.file(filename: String, mainID: String)



# Assets
GET           /webjars/*file                          controllers.WebJarAssets.at(file)
GET           /assets/*file                           controllers.Assets.versioned(path="/public", file: Asset)


# Route for direct get requests
GET           /tools/:toolname                        @controllers.Application.showTool(toolname : String)
# Redirects to a job with the jobID // mainID
GET           /jobs/:idString                         @controllers.Application.showJob(idString: String)

# File Uploader

POST          /upload                                 @controllers.Application.upload()


# Contact

# Routes for Auth Service
GET           /userData                               @controllers.Auth.getUserData
GET           /signin                                 @controllers.Auth.signIn(userName : String = "")
GET           /signin/:userName                       @controllers.Auth.signIn(userName : String)
POST          /signin/submit/                         @controllers.Auth.signInSubmit()
POST          /signin                                 @controllers.Auth.signInSubmit()
GET           /signup                                 @controllers.Auth.signUp()
POST          /signup                                 @controllers.Auth.signUpSubmit()
POST          /signup/submit/                         @controllers.Auth.signUpSubmit()
GET           /signout                                @controllers.Auth.signOut()
POST          /resetPassword                          @controllers.Auth.resetPassword
POST          /resetPasswordChange                    @controllers.Auth.resetPasswordChange
GET           /miniprofile                            @controllers.Auth.miniProfile()
GET           /profile                                @controllers.Auth.profile()
POST          /profile                                @controllers.Auth.profileSubmit()
POST          /password                               @controllers.Auth.passwordChangeSubmit()
POST          /profile/submit/userData/               @controllers.Auth.profileSubmit()
POST          /profile/submit/password/               @controllers.Auth.passwordChangeSubmit()
GET           /verification/:userName/:token          @controllers.Auth.verification(userName : String, token : String)
GET           /getCurrentUser                         @controllers.Auth.profile2json()

# Find a Job
GET           /jobs/find/:queryString                 @controllers.Search.getJob(queryString : String)
GET           /jobs                                   @controllers.Search.get
GET           /indexPageInfo                          @controllers.Search.getIndexPageInfo
# Update Job status
POST          /jobs/done/:jobID                       @controllers.Jobs.jobStatusDone(jobID : String)
POST          /jobs/error/:jobID                      @controllers.Jobs.jobStatusError(jobID : String)
POST          /jobs/running/:jobID                    @controllers.Jobs.jobStatusRunning(jobID : String)
POST          /jobs/queued/:jobID                     @controllers.Jobs.jobStatusQueued(jobID : String)
POST          /jobs/sge/:jobID/:sgeID                 @controllers.Jobs.SGEID(jobID: String, sgeID: String)
POST          /jobs/message/:mainID                   @controllers.Jobs.pushMessage(mainID, message: String)
POST          /jobs/dateviewed/:mainID                @controllers.Jobs.updateDateViewed(mainID)
# update process log
POST          /jobs/updateLog/:jobID                  @controllers.Jobs.updateLog(jobID : String)


# Validation Controller

GET           /validate/modeller/:input             @controllers.Validation.validateModellerKey(input: String)

# Cluster

GET           /load                                   @controllers.ClusterController.getLoad

# Static route
GET           /static/get/:static                     @controllers.Service.static(static : String)

# ElasticSearch

#GET     /search/jobs/:id                                   @controllers.Search.getJob(id: String)
#GET     /search:q                                          @controllers.Search.searchJob(q: String)
GET           /search/checkJobID/:jobID               @controllers.Search.checkJobID(jobID : String, resubmit : Boolean = false)
GET           /search/checkJobID/resubmit/:jobID      @controllers.Search.checkJobID(jobID : String, resubmit : Boolean = true)

#GET           /suggest/:jobID                         @controllers.Search.ac(jobID: String)
GET           /suggest/:jobID                         @controllers.Search.autoComplete(jobID: String)



# Sitemap
# Routes for static assets
GET           /:static                                @controllers.Application.static(static : String)


# GetTool
GET           /api/tools/:toolname                    @controllers.Service.getTool(toolname)


# Get list of userjobs
GET           /api/jobs                               @controllers.JobController.listJobs
POST          /api/job                                @controllers.JobController.create(toolname: String, jobID: String)
POST          /api/job/check                          @controllers.JobController.check(toolname: String, jobID: Option[String], hash: Boolean)
GET           /api/job/:jobID                         @controllers.Service.getJob(jobID)
GET           /api/job/result/:jobID/:tool/:panel            @controllers.Service.getResult(jobID : String, tool: String, panel: String)
DELETE        /api/job/:jobID                         @controllers.JobController.delete(jobID)
GET           /api/job/load/:jobID                    @controllers.JobController.loadJob(jobID: String)


# Frontend Stuff
POST          /api/frontendSubmit/:toolname           @controllers.Tool.frontendCount(toolname: String)

# Job Annotations

POST          /api/job/addnotes                       @controllers.Jobs.annotation(jobID: String, content : String ?= "")
GET           /api/jobs/getnotes/:jobID               @controllers.Jobs.getAnnotation(jobID: String)

# Results
GET           /api/job/results/:jobID                 @controllers.DataController.get(jobID: String)

# DataTables
GET          /api/job/results/dataTableHmmer/:jobID      @controllers.HmmerController.dataTable(jobID: String)
GET          /api/job/results/dataTablePSIBlast/:jobID   @controllers.PSIBlastController.dataTable(jobID: String)
GET          /api/job/results/dataTableHHpred/:jobID              @controllers.HHpredController.dataTable(jobID: String)
GET          /api/job/results/dataTableHHblits/:jobID              @controllers.HHblitsController.dataTable(jobID: String)
# Article
GET           /api/getRecentArticles/:numArticles     @controllers.DataController.getRecentArticles(numArticles: Integer)
POST          /api/writeArticle                       @controllers.DataController.writeArticle(title: String, text: String, link: String, imagePath: String)

# 3D structure
GET          /structure3D/:accession                  @controllers.HHpredController.show3DStructure(accession : String)
# get pdb structure
GET          /getStructure/:filename                  @controllers.Application.getStructureFile(filename : String)
# HHPRED
#template alignment
GET         /templateAlignment/:jobID/:accession        @controllers.HHpredController.runScript(jobID : String, accession : String)
#HHBlits
# template alignment
GET         /templateAlignmentHHblits/:jobID/:accession @controllers.HHblitsController.retrieveTemplateAlignment(jobID : String, accession : String)


# PSIBlast load hits on request
POST        /HmmerLoadHits                              @controllers.HmmerController.loadHits(jobID: String, start: Int, end: Int)
# Hmmer retrieve seqs with evale < threshold
POST         /alnEvalHmmer                              @controllers.HmmerController.alnEval(jobID: String, eval:String)
# Hmmer retrieve selected seqs
POST         /alnHmmer                                  @controllers.HmmerController.aln(jobID: String, listNum: Seq[Int])
# Hmmer retrieve seqs with evale < threshold
POST         /evalHmmerFull                              @controllers.HmmerController.evalFull(jobID: String, eval:String)
# Hmmer retrieve selected seqs
POST         /HmmerFull                                 @controllers.HmmerController.full(jobID: String, listNum: Seq[Int])

# PSIblast retrieve seqs with evalue < threshold
POST         /evalPSIBlast                               @controllers.PSIBlastController.alnEval(jobID: String, eval:String)
# PSIblast retrieve selected seqs
POST         /alnPSIBlast                                @controllers.PSIBlastController.aln(jobID:String, listNum: Seq[Int])
# PSIblast retrieve full seqs with evalue < threshold
POST        /evalPSIBlastFull                            @controllers.PSIBlastController.evalFull(jobID : String, eval: String)
# PSIblast retrieve selected full seqs
POST        /PSIBlastFull                              @controllers.PSIBlastController.full(jobID : String, listNum: Seq[Int])
# PSIBlast load hits on request
POST        /PSIBlastLoadHits                              @controllers.PSIBlastController.loadHits(jobID: String, start: Int, end: Int)

# HHblits retrieve seqs with evalue < threshold
POST         /evalHHBlits                              @controllers.HHblitsController.alnEval(jobID: String, eval:String)
#  HHblits retrieve selected seqs
POST         /alnHHBlits                           @controllers.HHblitsController.aln(jobID:String, listNum: Seq[Int])
# HHblits retrieve full seqs with evalue < threshold
POST        /evalHHBlitsFull                            @controllers.HHblitsController.evalFull(jobID : String, eval: String)
# HHblits retrieve selected full seqs
POST        /HHBlitsFull                              @controllers.HHblitsController.full(jobID : String, listNum: Seq[Int])
# PSIBlast load hits on request
POST        /HHblitsLoadHits                              @controllers.HHblitsController.loadHits(jobID: String, start: Int, end: Int)

# HHPred retrieve seqs with evalue < threshold
POST         /evalHHpred                           @controllers.HHpredController.alnEval(jobID: String, eval:String)
# HHpred retrieve selected seqs
POST         /alnHHpred                         @controllers.HHpredController.aln(jobID:String, listNum: Seq[Int])
# PSIBlast load hits on request
POST        /HHpredLoadHits                              @controllers.HHpredController.loadHits(jobID: String, start: Int, end: Int)

# ALignment load hits on request
POST        /AlignmentLoadHits                              @controllers.AlignmentController.loadHits(jobID: String, start: Int, end: Int, resultName: String)
# fetch alignment
POST        /AlignmentGetAln                              @controllers.AlignmentController.getAln(jobID: String, listNum: Seq[Int], resultName: String)