@import models.results.BlastVisualization
@import models.database.results.PSIBlastHSP
@(jobID: String, hit: PSIBlastHSP, db: String, wrapped: Boolean)(implicit request: RequestHeader)
@* hit number, links *@
<tr>
    <td></td>
    <td colspan="3">

        @BlastVisualization.getLinksDB(db, hit.accession)
    </td>
    <td></td>
</tr>
@* checkboxes, accession, name of hit*@
<tr class="header">
    <td class="indexCheckbox"><input type="checkbox" name="alignment_elem" class="checkbox aln" value='@{hit.num}'> @{hit.num}.</td>
<td class="hitInfo" colspan="4">
    @{BlastVisualization.getSingleLinkDB(db , hit.accession)}
    @{"  "+hit.description}
</td>
</tr>
@* Alignment Details*@
<tr>
    <td></td>
    <td class="hitInfo" colspan="4">
        Length: @{hit.ref_len} <br>
        E-value: @{hit.evalue}&emsp;&emsp;Score: @{hit.bitscore}bits (@{hit.score})&emsp;&emsp;
        Identities: @{hit.identity}/@{hit.hit_len}
        (@{BlastVisualization.calculatePercentage(hit.identity, hit.hit_len)})&emsp;&emsp;
        Positives: @{hit.positive}/@{hit.hit_len}
        (@{BlastVisualization.calculatePercentage(hit.positive, hit.hit_len)})&emsp;&emsp;
        Gaps: @{hit.gaps}/@{hit.hit_len}
        (@{BlastVisualization.calculatePercentage(hit.gaps, hit.hit_len)})

    </td>
</tr>
<tr>
    <td><br /></td>
</tr>
    @* Query *@

@if(wrapped) {

    @Html(BlastVisualization.psiblastHitWrapped(hit, 0, 80, hit.query_start, hit.hit_start))
} else {
    @{
        BlastVisualization.makeRow("sequence", Array("", "Q  " + hit.query_start.toString, hit.query_seq+ "   " + hit.query_end.toString))
    }
    @* Midline *@
    @{
        BlastVisualization.makeRow("sequence", Array("", "", hit.midline))
    }
    @* Hit *@
    @{
        BlastVisualization.makeRow("sequence", Array("", "T  " + hit.hit_start.toString, hit.hit_seq + "   " + hit.hit_end.toString))
    }
}
<tr>
    <td colspan="5"><hr id="line-element" class="horizontal-line"></td>
</tr>