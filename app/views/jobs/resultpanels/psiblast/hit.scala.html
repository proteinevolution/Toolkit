@import models.results.BlastVisualization
@import models.database.results.PSIBlastHSP
@(jobID: String, hit: PSIBlastHSP, db: String)(implicit request: RequestHeader)
@* hit number, links *@
<tr>
    <td></td>
    <td colspan="3">

        @BlastVisualization.getLinksDB(db, hit.accession)
    </td>
    <td></td>
</tr>
@* checkboxes, accession, name of hit*@
<tr class="header">
    @if(hit.checked){
        <td class="indexCheckbox"><input type="checkbox" checked="true" name="alignment_elem" class="checkbox aln" value='@{hit.num}'> @{hit.num}.</td>
    }else{
        <td class="indexCheckbox"><input type="checkbox" name="alignment_elem" class="checkbox aln" value='@{hit.num}'> @{hit.num}.</td>
    }
<td class="hitInfo" colspan="4">
    @{BlastVisualization.getSingleLinkDB(db , hit.accession)}
    @{"  "+hit.description}
</td>
</tr>
@* Alignment Details*@
<tr>
    <td></td>
    <td class="hitInfo" colspan="4">
        E-value: @{hit.evalue}&emsp;&emsp;Score: @{hit.bitscore}bits (@{hit.score})&emsp;&emsp;
        Identities: @{hit.identity}/@{hit.hit_len}
        (@{BlastVisualization.calculatePercentage(hit.identity, hit.hit_len)})&emsp;&emsp;
        Positives: @{hit.positive}/@{hit.hit_len}
        (@{BlastVisualization.calculatePercentage(hit.positive, hit.hit_len)})&emsp;&emsp;
        Gaps: @{hit.gaps}/@{hit.hit_len}
        (@{BlastVisualization.calculatePercentage(hit.gaps, hit.hit_len)})&emsp;&emsp;
        Aligned positions: @{hit.hit_len}</b>
    </td>
</tr>
<tr>
    <td><br /></td>
</tr>
@* color only 150 first hits, to avoid bloating of the generated html*@
    @* Query *@
    @if(hit.num > 0) {
        @{
            BlastVisualization.makeRow("sequence", Array("", "Q  " + hit.query_start.toString, hit.query_seq+ "   " + hit.query_end.toString))
        }
        @* Midline *@
        @{
            BlastVisualization.makeRow("sequence", Array("", "", hit.midline))
        }
        @* Hit *@
        @{
            BlastVisualization.makeRow("sequence", Array("", "T  " + hit.hit_start.toString, hit.hit_seq + "   " + hit.hit_end.toString))
        }
    }else{

        @{
            BlastVisualization.makeRow("sequence", Array("", "Q  " + hit.query_start.toString, BlastVisualization.colorRegexReplacer(hit.query_seq)+ "   " + hit.query_end.toString))
        }
        @* Midline *@
        @{
            BlastVisualization.makeRow("sequence", Array("", "", BlastVisualization.colorRegexReplacer(hit.midline)))
        }
        @* Hit *@
        @{
            BlastVisualization.makeRow("sequence", Array("", "T  " + hit.hit_start.toString, BlastVisualization.colorRegexReplacer(hit.hit_seq) + "   " + hit.hit_end.toString))
        }
    }
<tr>
    <td colspan="5"><hr id="line-element" class="horizontal-line"></td>
</tr>