@import de.proteinevolution.tools.results.HHrepID
@(jobID: String, filePath: String, resultName: String, tool: de.proteinevolution.models.Tool)()
@views.html.forwardmodals.simpler(tool, resultName)
@views.html.forwardmodals.hhsuite(tool, tool.toolNameShort + "_hhrepid")

@if(HHrepID.existsResult(filePath)) {
    <div class="colorOptsAlignment">
        <a id="forwardButtonHHsuite" data-open="forwardModal_@{
            tool.toolNameShort
        }_hhrepid">Forward Query A3M</a>
        <hr id="line-element" class="horizontal-line">
    </div>
    <div class="note">
    Your protein may contain additional repeats. To detect them, please re-run HHrepID with an increased number of MSA
        generation steps and/or run an HHpred search against the PDB_mmCIF70 or SCOPe70 database. You could use the
        'Forward Query A3M' option to forward the MSA generated by HHrepID to HHpred.
    </div>

    <div class="hhrepidResult">
    @HHrepID.getResult(jobID, filePath)
    </div>
    <br/><br/>
    <br/><hr><br/>
    <div id="toolReferences">
        If you use @{tool.toolNameLong} on our Toolkit for your research, please cite:
        <div class="citation">
            @views.html.help.common.toolkit_citation_results()
            <br>
            <div>De novo identification of highly diverged protein repeats by probabilistic consistency.<br>
                Biegert A, Söding J.<a href="https://academic.oup.com/bioinformatics/article-lookup/doi/10.1093/bioinformatics/btn039" target="_blank" rel="noopener"> Bioinformatics. 2008 Mar 15;24(6):807-14.</a></div>
        </div>
        <hr id="line-element" class="horizontal-line">
    </div>
}else{
    <div class="colorOptsAlignment">
        <a id="forwardButtonHHsuite" data-open="forwardModal_@{
            tool.toolNameShort
        }_hhrepid">Forward Query A3M</a>
        <hr id="line-element" class="horizontal-line">
    </div>

    <div class="note">No repeats found!<br/>
    Please try increasing the number of MSA generation steps or input your own custom MSA and set
        MSA generation steps to 0.</div>
    <br/><br/>
    <br/><hr><br/>
    <div id="toolReferences">
        If you use HHrepID on our Toolkit for your research, please cite:
        <div class="citation">
            @views.html.help.common.toolkit_citation_results()
            <br>
            <div>De novo identification of highly diverged protein repeats by probabilistic consistency.<br>
                Biegert A, Söding J.<a href="https://academic.oup.com/bioinformatics/article-lookup/doi/10.1093/bioinformatics/btn039" target="_blank" rel="noopener"> Bioinformatics. 2008 Mar 15;24(6):807-14.</a></div>
        </div>
        <hr id="line-element" class="horizontal-line">
    </div>
}

<script>

        function @{tool.toolNameShort}_forwardQueryMSA(selectedTool) {
            $.LoadingOverlay("show");
            $.ajax({
                type: 'GET',
                url: 'files/@jobID/reduced.a3m'
            }).done(function (data_) {
                forward(selectedTool, data_.toString());
            });
        }

</script>
