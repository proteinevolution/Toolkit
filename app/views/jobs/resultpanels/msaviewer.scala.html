@import play.api.mvc.RequestHeader

@(pathToAlignmentFile : String)(implicit request: RequestHeader)
<h3><a href="http://msa.biojs.net" target="_blank">BioJS MSA Viewer</a> (Full Alignment)</h3>

<div id="menuDiv"></div>
<div id="yourDiv">Loading ... </div>


<style>


//div[style] {

//top: 275px !important;

//}

</style>


<script>
        // this is a way how you use a bundled file parser
        msa = require("msa");

        var opts = {colorscheme: {"scheme": "clustal"}};

        opts.el = document.getElementById("yourDiv");
        opts.vis = {
            conserv: false,
            overviewbox: false,
            seqlogo: false,

            labels: true,
            labelName: true,
            labelId: false,
            labelPartition: false,
            labelCheckbox: false
        };
        opts.conf = {
            dropImport: true
        };
        opts.zoomer = {
            // Alignment viewer is not scrolling with 'alignmentWidth: "auto"', use fixed numbers instead or
            // use script for handling
            alignmentHeight: 825, alignmentWidth: 600, labelNameLength: 165, labelWidth: 85,labelFontsize: "13px",labelIdLength: 75,   menuFontsize: "12px",menuMarginLeft: "2px", menuPadding: "0px 10px 0px 0px", menuItemFontsize: "14px", menuItemLineHeight: "14px", autoResize: true
        };

        // init msa
        var ms = new msa.msa(opts);
        var url = '@pathToAlignmentFile';

        ms.u.file.importURL(url, renderMSA);

        function renderMSA() {

            // the menu is independent to the MSA container
            var menuOpts = {};
            menuOpts.el = document.getElementById('div');
            menuOpts.msa = ms;
            var defMenu = new msa.menu.defaultmenu(menuOpts);
            ms.addView("menu", defMenu);

            // Author: Seung-Zin Nam
            // bugfix: here we shift the sequence ids back to their correct value via the backbone.js api !!!
            // TODO: We need to speed up this process or find a workaround

            //var sequenceId = new Array(m.seqs.length);
            //for (var i=0; i<sequenceId.length; i++) {
            //sequenceId[i] = m.seqs.at(i).get("id");
            //if(!isNaN(sequenceId[i])){
            //m.seqs.at(i).set("id", sequenceId[i]-1);}}


            // call render at the end to display the whole MSA
            ms.render();
        }
</script>
