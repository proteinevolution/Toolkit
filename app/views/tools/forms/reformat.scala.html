@import play.api.mvc.RequestHeader
@(webJarAssets: WebJarAssets, sectionname : String)(implicit messages: Messages, request: RequestHeader)
<link href="@routes.Assets.at("styles/reformat.css")" rel="stylesheet">
<link href="@routes.Assets.at("styles/reformat-common.css")" rel="stylesheet">
<link href="@routes.Assets.at("styles/reformat-jobview.css")" rel="stylesheet">
<script src="@routes.WebJarAssets.at(webJarAssets.locate("reformat.js"))"></script>
<div style="padding-top: 10px;"></div>
<div style="display: block; margin: auto;">


    <div class="tool-tabs ui-tabs ui-widget ui-widget-content ui-corner-all" id="tool-tabs" style="">

            <ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all" role="tablist">


                <li id="tab-Alignment" class="ui-state-default ui-corner-top ui-tabs-active ui-state-active" role="tab" tabindex="0" aria-controls="tabpanel-Alignment" aria-labelledby="ui-id-4" aria-selected="true" aria-expanded="true"><a href="#tabpanel-Alignment" class="ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-4">Reformat View</a></li>


                <li id="tab-Freqs" class="ui-state-default ui-corner-top" role="tab" tabindex="-1" aria-controls="tabpanel-Freqs" aria-labelledby="ui-id-5" aria-selected="false" aria-expanded="false"><a href="#tabpanel-Freqs" class="ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-5">Relative Frequencies</a></li>


            </ul>



            <div class="tabs-panel ui-tabs-panel ui-widget-content ui-corner-bottom" id="tabpanel-Alignment" aria-labelledby="ui-id-4" role="tabpanel" aria-hidden="false">

                <div id="reformatcontainer" style="min-width: 610px; min-height: 800px; margin: 0 auto">

                    <ul class="vertical menu" data-accordion-menu>
                        <li>
                            <a href="#"><span id="reformat">&nbsp;<i class="icon-chevron_down"></i> Reformat Converter</span></a>
                            <ul class="menu horizontal nested">
                                <li><a download="export.txt" class="download" onclick="downloadResult()">Export</a></li>
                                <li><a id="dropzonetoggle">Upload</a></li>
                                <li><a data-open="alnvizmodal" onclick="initMSA()">AlignmentViewer</a></li>
                                <li><a onclick="myCodeMirror.setValue('');myCodeMirror2.setValue('')">Clear</a></li>
                                <li style="padding-top: 15px; padding-left: 10px;">
                                    <select id="forwardTool">
                                        <option selected>Forward To</option>
                                        <option  id="clans" onclick="forward('clans')" value="psi">Clans</option>
                                        <option  id="csblast" onclick="forward('csblast')" value="psi">CS-BLAST</option>
                                        <option  id="hhblits" onclick="forward('hhblits')" value="psi">HHblits</option>
                                        <option  id="hhpred" onclick="forward('hhpred')" value="psi">HHpred</option>
                                        <option  id="hmmer3" onclick="forward('hmmer3')" value="psi">Hmmer3</option>
                                        <option  id="mafft" onclick="forward('mafft')" value="psi">Mafft</option>
                                        <option  id="psiblast" onclick="forward('psiblast')" value="psi">PSI-BLAST</option>
                                        <option  id="tcoffee" onclick="forward('tcoffee')" value="psi">T-Coffee</option>
                                    </select>
                                </li>
                            </ul>
                        </li>
                    </ul>


                <div class="large-6 large-centered columns" id="dropzonewrapper" style="display: none;">
                    <div id="progress_bar"><div class="percent">0%</div></div>
                    <input type="file" id="files" name="file" />
                        <!--<div id="drop_zone" type="file" class="dropzone" name="file" style="margin-top: 10px; text-align: center; line-height: 150px; vertical-align: middle;">Drop files here</div>-->
                    <output id="list"></output>


                </div>
                <div style="width: 95%; display: block; margin: auto; padding-top: 15px;">
                    <div class="large-12 columns" style="padding-right: 12px;">
                        <div style="float: right; z-index: 9;">
                            <span data-tooltip aria-haspopup="true" class="has-tip top" tabindex="1" title="Paste output as input">
                                <button class="small button" id="copy-button" data-clipboard-target="#outputarea" onclick="pasteLeft()" style="margin: 0 -5px 0 0;">Paste</button></span>
                            <span data-tooltip aria-haspopup="true" class="has-tip top" tabindex="1" title="Copy output to clipboard">
                                <button class="small button warning" id="copy-button" data-clipboard-target="#outputarea" onclick="(function(){
                                new Clipboard('#copy-button');
                                })();" style="margin: 0 0 0 0;">Copy</button></span>
                        </div>
                    </div>
                    <div class="large-12 columns">
                        <div id="inputMirror" style="width: 99%; border: 1px solid lightgray ;"></div>
                    </div>
                    <div class="large-12 columns" style="padding-top: 9px;">
                        <div id="outputMirror" style="width: 99%; border: 1px solid lightgray ;"></div>
                    </div>


                </div>
                <p>&nbsp;</p>

                <div class="show-for-medium large-12 columns" style="padding-top: 20px;">
                    <div class="success callout" id="callout" data-closable="slide-out-right" style="width: 50%; display: block; margin: auto;">
                        <p style="width: 80%;">Found <span id="nonalignedwarning" style="color: red; display: none;">non-aligned</span> <span id="format"></span> formatted input.</p>
                        <button class="close-button" aria-label="Dismiss alert" type="button" data-close>
                            <span aria-hidden="true">&times;</span>
                        </button>

                        <label>Select Output Format
                            <select id="outformat">
                                <option selected>Choose</option>
                                <option id="Fasta" value="Fasta">Fasta</option>
                                <option id="A3M" value="A3M">A3M</option>
                                <option id="Clustal" value="Clustal" class="clustaloption">CLUSTAL</option>
                                <option id="Phylip" value="Phylip" class="clustaloption">PHYLIP</option>
                                <option id="Stockholm" value="Stockholm">STOCKHOLM</option>
                                <option id="PIR" value="PIR">PIR</option>
                                <option id="EMBL" value="EMBL">EMBL</option>
                                <option id="NEXUS" value="NEXUS">Nexus</option>
                                <option id="Genbank" value="Genbank">Genbank</option>
                                <option id="GetGIs" value="GetGIs">Extract GIs</option>
                                <option id="Consensus" value="Consensus">Consensus</option>
                                <option id="Alphabet" value="Alphabet">Alphabet</option>
                            </select>
                        </label>
                    </div>

                </div>
                <p>&nbsp;</p>
                <p>&nbsp;</p>

                <div class="large reveal" id="alnvizmodal" data-reveal>
                    <h1>AlignmentViewer</h1>

                    <div id="menuDiv"></div>
                    <div id="yourDiv">Loading ... </div>
                    <button class="close-button" data-close aria-label="Close modal" type="button">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

              </div>

            </div>


            <div class="tabs-panel ui-tabs-panel ui-widget-content ui-corner-bottom" id="tabpanel-Freqs" aria-labelledby="ui-id-5" role="tabpanel" style="display: none;" aria-hidden="true">

                    <div id="hcontainer" style="min-width: 610px; height: 400px; margin: 0 auto" data-highcharts-chart="1"><div class="highcharts-container" id="highcharts-4" style="position: relative; overflow: hidden; width: 610px; height: 400px; text-align: left; line-height: normal; z-index: 0; left: 0px; top: 0px;"><svg version="1.1" style="font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Arial, Helvetica, sans-serif;font-size:12px;" xmlns="http://www.w3.org/2000/svg" width="610" height="400"><desc>Created with Highcharts 4.2.4</desc><defs><clipPath id="highcharts-5"><rect x="0" y="0" width="427" height="299"></rect></clipPath></defs><rect x="0" y="0" width="610" height="400" fill="#FFFFFF" class=" highcharts-background"></rect><g class="highcharts-grid"></g><g class="highcharts-grid"><path fill="none" d="M 70 345.5 L 497 345.5" stroke="#D8D8D8" stroke-width="1" opacity="1"></path><path fill="none" d="M 70 295.5 L 497 295.5" stroke="#D8D8D8" stroke-width="1" opacity="1"></path><path fill="none" d="M 70 245.5 L 497 245.5" stroke="#D8D8D8" stroke-width="1" opacity="1"></path><path fill="none" d="M 70 196.5 L 497 196.5" stroke="#D8D8D8" stroke-width="1" opacity="1"></path><path fill="none" d="M 70 146.5 L 497 146.5" stroke="#D8D8D8" stroke-width="1" opacity="1"></path><path fill="none" d="M 70 96.5 L 497 96.5" stroke="#D8D8D8" stroke-width="1" opacity="1"></path><path fill="none" d="M 70 45.5 L 497 45.5" stroke="#D8D8D8" stroke-width="1" opacity="1"></path></g><g class="highcharts-axis"><path fill="none" d="M 73.5 345 L 73.5 355" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><path fill="none" d="M 143.5 345 L 143.5 355" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><path fill="none" d="M 213.5 345 L 213.5 355" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><path fill="none" d="M 283.5 345 L 283.5 355" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><path fill="none" d="M 353.5 345 L 353.5 355" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><path fill="none" d="M 423.5 345 L 423.5 355" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><path fill="none" d="M 493.5 345 L 493.5 355" stroke="#C0D0E0" stroke-width="1" opacity="1"></path><text x="283.5" text-anchor="middle" transform="translate(0,0)" class=" highcharts-xaxis-title" style="color:#707070;fill:#707070;" y="383">-log(E-Value)</text><path fill="none" d="M 70 345.5 L 497 345.5" stroke="#C0D0E0" stroke-width="1"></path></g><g class="highcharts-axis"><text x="24" text-anchor="middle" transform="translate(0,0) rotate(270 24 195.5)" class=" highcharts-yaxis-title" style="color:#707070;fill:#707070;" y="195.5"><tspan>No. of HSPs below E-Value</tspan></text></g><g class="highcharts-series-group"><path fill="#7cb5ec" fill-opacity="0.25" d="M 0 0"></path><g class="highcharts-series highcharts-series-0" transform="translate(70,46) scale(1 1)" clip-path="url(#highcharts-5)"><path fill="none" d="M 4.186274509803922 249.16666666666666 L 5.586366319102892 249.16666666666666 L 6.986458128401862 49.833333333333314 L 8.386549937700833 49.833333333333314 L 9.786641746999802 49.833333333333314 L 11.186733556298773 49.833333333333314 L 12.586825365597743 49.833333333333314 L 13.986917174896714 49.833333333333314 L 15.387008984195683 49.833333333333314 L 16.787100793494655 49.833333333333314 L 18.187192602793623 49.833333333333314 L 19.587284412092593 49.833333333333314 L 20.987376221391564 49.833333333333314 L 22.387468030690535 49.833333333333314 L 23.78755983998951 49.833333333333314 L 25.187651649288476 49.833333333333314 L 26.587743458587447 49.833333333333314 L 27.987835267886418 49.833333333333314 L 29.387927077185388 49.833333333333314 L 30.78801888648436 49.833333333333314 L 32.18811069578333 49.833333333333314 L 33.5882025050823 49.833333333333314 L 34.98829431438127 49.833333333333314 L 36.38838612368024 49.833333333333314 L 37.78847793297921 49.833333333333314 L 39.18856974227818 49.833333333333314 L 40.588661551577154 49.833333333333314 L 41.98875336087612 49.833333333333314 L 43.38884517017509 49.833333333333314 L 44.78893697947406 49.833333333333314 L 46.18902878877303 49.833333333333314 L 47.589120598072 49.833333333333314 L 48.98921240737097 49.833333333333314 L 50.38930421666994 49.833333333333314 L 51.78939602596891 49.833333333333314 L 53.18948783526788 49.833333333333314 L 54.589579644566854 49.833333333333314 L 55.989671453865824 49.833333333333314 L 57.389763263164795 49.833333333333314 L 58.789855072463766 49.833333333333314 L 60.18994688176274 49.833333333333314 L 61.59003869106171 49.833333333333314 L 62.99013050036068 49.833333333333314 L 64.39022230965965 49.833333333333314 L 65.79031411895862 49.833333333333314 L 67.19040592825759 49.833333333333314 L 68.59049773755656 49.833333333333314 L 69.99058954685553 49.833333333333314 L 71.3906813561545 49.833333333333314 L 72.79077316545347 49.833333333333314 L 74.19086497475244 49.833333333333314 L 75.5909567840514 49.833333333333314 L 76.99104859335037 49.833333333333314 L 78.39114040264934 49.833333333333314 L 79.79123221194831 49.833333333333314 L 81.19132402124728 49.833333333333314 L 82.59141583054625 49.833333333333314 L 83.99150763984522 49.833333333333314 L 85.3915994491442 49.833333333333314 L 86.79169125844317 49.833333333333314 L 88.19178306774214 49.833333333333314 L 89.5918748770411 49.833333333333314 L 90.99196668634006 49.833333333333314 L 92.39205849563903 49.833333333333314 L 93.792150304938 49.833333333333314 L 95.19224211423698 49.833333333333314 L 96.59233392353595 49.833333333333314 L 97.99242573283492 49.833333333333314 L 99.39251754213389 49.833333333333314 L 100.79260935143286 49.833333333333314 L 102.19270116073183 49.833333333333314 L 103.5927929700308 49.833333333333314 L 104.99288477932977 49.833333333333314 L 106.39297658862874 49.833333333333314 L 107.79306839792771 49.833333333333314 L 109.19316020722668 49.833333333333314 L 110.59325201652565 49.833333333333314 L 111.99334382582462 49.833333333333314 L 113.3934356351236 49.833333333333314 L 114.79352744442257 49.833333333333314 L 116.19361925372154 49.833333333333314 L 117.5937110630205 49.833333333333314 L 118.99380287231948 49.833333333333314 L 120.39389468161845 49.833333333333314 L 121.79398649091742 49.833333333333314 L 123.19407830021639 49.833333333333314 L 124.59417010951536 49.833333333333314 L 125.99426191881433 49.833333333333314 L 127.3943537281133 49.833333333333314 L 128.79444553741226 49.833333333333314 L 130.19453734671123 49.833333333333314 L 131.5946291560102 49.833333333333314 L 132.99472096530917 49.833333333333314 L 134.39481277460814 49.833333333333314 L 135.7949045839071 49.833333333333314 L 137.19499639320608 49.833333333333314 L 138.59508820250505 49.833333333333314 L 139.99518001180402 49.833333333333314 L 141.395271821103 49.833333333333314 L 142.79536363040197 49.833333333333314 L 144.19545543970094 49.833333333333314 L 145.5955472489999 49.833333333333314 L 146.99563905829888 49.833333333333314 L 148.39573086759785 49.833333333333314 L 149.79582267689682 49.833333333333314 L 151.1959144861958 49.833333333333314 L 152.59600629549476 49.833333333333314 L 153.99609810479373 49.833333333333314 L 155.3961899140927 49.833333333333314 L 156.79628172339167 49.833333333333314 L 158.19637353269064 49.833333333333314 L 159.5964653419896 49.833333333333314 L 160.99655715128858 49.833333333333314 L 162.39664896058756 49.833333333333314 L 163.79674076988653 49.833333333333314 L 165.1968325791855 49.833333333333314 L 166.59692438848447 49.833333333333314 L 167.99701619778344 49.833333333333314 L 169.3971080070824 49.833333333333314 L 170.79719981638138 49.833333333333314 L 172.19729162568035 49.833333333333314 L 173.59738343497932 49.833333333333314 L 174.9974752442783 49.833333333333314 L 176.39756705357726 49.833333333333314 L 177.79765886287623 49.833333333333314 L 179.1977506721752 49.833333333333314 L 180.59784248147417 49.833333333333314 L 181.99793429077314 49.833333333333314 L 183.39802610007212 49.833333333333314 L 184.7981179093711 49.833333333333314 L 186.19820971867006 49.833333333333314 L 187.59830152796903 49.833333333333314 L 188.998393337268 49.833333333333314 L 190.39848514656697 49.833333333333314 L 191.79857695586594 49.833333333333314 L 193.1986687651649 49.833333333333314 L 194.59876057446388 49.833333333333314 L 195.99885238376285 49.833333333333314 L 197.39894419306182 49.833333333333314 L 198.7990360023608 49.833333333333314 L 200.19912781165976 49.833333333333314 L 201.59921962095873 49.833333333333314 L 202.9993114302577 49.833333333333314 L 204.39940323955668 49.833333333333314 L 205.79949504885565 49.833333333333314 L 207.19958685815462 49.833333333333314 L 208.5996786674536 49.833333333333314 L 209.99977047675256 49.833333333333314 L 211.39986228605153 49.833333333333314 L 212.7999540953505 49.833333333333314 L 214.20004590464947 49.833333333333314 L 215.60013771394844 49.833333333333314 L 217.0002295232474 49.833333333333314 L 218.40032133254638 49.833333333333314 L 219.80041314184535 49.833333333333314 L 221.20050495114432 49.833333333333314 L 222.6005967604433 49.833333333333314 L 224.00068856974227 49.833333333333314 L 225.40078037904124 49.833333333333314 L 226.8008721883402 49.833333333333314 L 228.20096399763918 49.833333333333314 L 229.60105580693815 49.833333333333314 L 231.00114761623712 49.833333333333314 L 232.4012394255361 49.833333333333314 L 233.80133123483506 49.833333333333314 L 235.20142304413403 49.833333333333314 L 236.601514853433 49.833333333333314 L 238.00160666273197 49.833333333333314 L 239.40169847203094 49.833333333333314 L 240.80179028132991 49.833333333333314 L 242.20188209062889 49.833333333333314 L 243.60197389992786 49.833333333333314 L 245.00206570922683 49.833333333333314 L 246.4021575185258 49.833333333333314 L 247.80224932782477 49.833333333333314 L 249.20234113712374 49.833333333333314 L 250.6024329464227 49.833333333333314 L 252.00252475572168 49.833333333333314 L 253.40261656502065 49.833333333333314 L 254.80270837431962 49.833333333333314 L 256.2028001836186 49.833333333333314 L 257.60289199291753 49.833333333333314 L 259.00298380221653 49.833333333333314 L 260.4030756115155 49.833333333333314 L 261.8031674208145 49.833333333333314 L 263.2032592301134 49.833333333333314 L 264.6033510394124 49.833333333333314 L 266.00344284871136 49.833333333333314 L 267.40353465801036 49.833333333333314 L 268.8036264673093 49.833333333333314 L 270.2037182766083 49.833333333333314 L 271.60381008590724 49.833333333333314 L 273.00390189520624 49.833333333333314 L 274.4039937045052 49.833333333333314 L 275.8040855138042 49.833333333333314 L 277.2041773231031 49.833333333333314 L 278.6042691324021 49.833333333333314 L 280.00436094170107 49.833333333333314 L 281.40445275100006 49.833333333333314 L 282.804544560299 49.833333333333314 L 284.204636369598 49.833333333333314 L 285.60472817889695 49.833333333333314 L 287.00481998819595 49.833333333333314 L 288.4049117974949 49.833333333333314 L 289.8050036067939 49.833333333333314 L 291.20509541609283 49.833333333333314 L 292.60518722539183 49.833333333333314 L 294.0052790346908 49.833333333333314 L 295.4053708439898 49.833333333333314 L 296.8054626532887 49.833333333333314 L 298.2055544625877 49.833333333333314 L 299.60564627188666 49.833333333333314 L 301.00573808118565 49.833333333333314 L 302.4058298904846 49.833333333333314 L 303.8059216997836 49.833333333333314 L 305.20601350908254 49.833333333333314 L 306.60610531838154 49.833333333333314 L 308.0061971276805 49.833333333333314 L 309.4062889369794 49.833333333333314 L 310.8063807462784 49.833333333333314 L 312.20647255557736 49.833333333333314 L 313.60656436487636 49.833333333333314 L 315.0066561741753 49.833333333333314 L 316.4067479834743 49.833333333333314 L 317.80683979277325 49.833333333333314 L 319.20693160207225 49.833333333333314 L 320.6070234113712 49.833333333333314 L 322.0071152206702 49.833333333333314 L 323.40720702996913 49.833333333333314 L 324.8072988392681 49.833333333333314 L 326.20739064856707 49.833333333333314 L 327.60748245786607 49.833333333333314 L 329.007574267165 49.833333333333314 L 330.407666076464 49.833333333333314 L 331.80775788576295 49.833333333333314 L 333.20784969506195 49.833333333333314 L 334.6079415043609 49.833333333333314 L 336.0080333136599 49.833333333333314 L 337.40812512295884 49.833333333333314 L 338.80821693225784 49.833333333333314 L 340.2083087415568 49.833333333333314 L 341.6084005508558 49.833333333333314 L 343.0084923601547 49.833333333333314 L 344.4085841694537 49.833333333333314 L 345.80867597875266 49.833333333333314 L 347.20876778805166 49.833333333333314 L 348.6088595973506 49.833333333333314 L 350.0089514066496 49.833333333333314 L 351.40904321594854 49.833333333333314 L 352.80913502524754 49.833333333333314 L 354.2092268345465 49.833333333333314 L 355.6093186438455 49.833333333333314 L 357.0094104531444 49.833333333333314 L 358.4095022624434 49.833333333333314 L 359.80959407174237 49.833333333333314 L 361.20968588104137 49.833333333333314 L 362.6097776903403 49.833333333333314 L 364.0098694996393 49.833333333333314 L 365.40996130893825 49.833333333333314 L 366.81005311823725 49.833333333333314 L 368.2101449275362 49.833333333333314 L 369.6102367368352 49.833333333333314 L 371.01032854613413 49.833333333333314 L 372.41042035543313 49.833333333333314 L 373.8105121647321 49.833333333333314 L 375.2106039740311 49.833333333333314 L 376.61069578333 49.833333333333314 L 378.010787592629 49.833333333333314 L 379.41087940192796 49.833333333333314 L 380.81097121122696 49.833333333333314 L 382.2110630205259 49.833333333333314 L 383.6111548298249 49.833333333333314 L 385.01124663912384 49.833333333333314 L 386.41133844842284 49.833333333333314 L 387.8114302577218 49.833333333333314 L 389.2115220670208 49.833333333333314 L 390.6116138763197 49.833333333333314 L 392.0117056856187 49.833333333333314 L 393.41179749491766 49.833333333333314 L 394.81188930421666 49.833333333333314 L 396.2119811135156 49.833333333333314 L 397.6120729228146 49.833333333333314 L 399.01216473211355 49.833333333333314 L 400.4122565414125 49.833333333333314 L 401.8123483507115 49.833333333333314 L 403.21244016001043 49.833333333333314 L 404.61253196930943 49.833333333333314 L 406.0126237786084 49.833333333333314 L 407.41271558790737 49.833333333333314 L 408.8128073972063 49.833333333333314 L 410.2128992065053 49.833333333333314 L 411.61299101580425 49.833333333333314 L 413.01308282510325 49.833333333333314 L 414.4131746344022 49.833333333333314 L 415.8132664437012 49.833333333333314 L 417.21335825300014 49.833333333333314 L 418.61345006229914 49.833333333333314 L 420.0135418715981 49.833333333333314 L 421.4136336808971 49.833333333333314 L 422.813725490196 49.833333333333314" stroke="#7cb5ec" stroke-width="2" stroke-linejoin="round" stroke-linecap="round"></path><path fill="none" d="M -5.813725490196078 249.16666666666666 L 4.186274509803922 249.16666666666666 L 5.586366319102892 249.16666666666666 L 6.986458128401862 49.833333333333314 L 8.386549937700833 49.833333333333314 L 9.786641746999802 49.833333333333314 L 11.186733556298773 49.833333333333314 L 12.586825365597743 49.833333333333314 L 13.986917174896714 49.833333333333314 L 15.387008984195683 49.833333333333314 L 16.787100793494655 49.833333333333314 L 18.187192602793623 49.833333333333314 L 19.587284412092593 49.833333333333314 L 20.987376221391564 49.833333333333314 L 22.387468030690535 49.833333333333314 L 23.78755983998951 49.833333333333314 L 25.187651649288476 49.833333333333314 L 26.587743458587447 49.833333333333314 L 27.987835267886418 49.833333333333314 L 29.387927077185388 49.833333333333314 L 30.78801888648436 49.833333333333314 L 32.18811069578333 49.833333333333314 L 33.5882025050823 49.833333333333314 L 34.98829431438127 49.833333333333314 L 36.38838612368024 49.833333333333314 L 37.78847793297921 49.833333333333314 L 39.18856974227818 49.833333333333314 L 40.588661551577154 49.833333333333314 L 41.98875336087612 49.833333333333314 L 43.38884517017509 49.833333333333314 L 44.78893697947406 49.833333333333314 L 46.18902878877303 49.833333333333314 L 47.589120598072 49.833333333333314 L 48.98921240737097 49.833333333333314 L 50.38930421666994 49.833333333333314 L 51.78939602596891 49.833333333333314 L 53.18948783526788 49.833333333333314 L 54.589579644566854 49.833333333333314 L 55.989671453865824 49.833333333333314 L 57.389763263164795 49.833333333333314 L 58.789855072463766 49.833333333333314 L 60.18994688176274 49.833333333333314 L 61.59003869106171 49.833333333333314 L 62.99013050036068 49.833333333333314 L 64.39022230965965 49.833333333333314 L 65.79031411895862 49.833333333333314 L 67.19040592825759 49.833333333333314 L 68.59049773755656 49.833333333333314 L 69.99058954685553 49.833333333333314 L 71.3906813561545 49.833333333333314 L 72.79077316545347 49.833333333333314 L 74.19086497475244 49.833333333333314 L 75.5909567840514 49.833333333333314 L 76.99104859335037 49.833333333333314 L 78.39114040264934 49.833333333333314 L 79.79123221194831 49.833333333333314 L 81.19132402124728 49.833333333333314 L 82.59141583054625 49.833333333333314 L 83.99150763984522 49.833333333333314 L 85.3915994491442 49.833333333333314 L 86.79169125844317 49.833333333333314 L 88.19178306774214 49.833333333333314 L 89.5918748770411 49.833333333333314 L 90.99196668634006 49.833333333333314 L 92.39205849563903 49.833333333333314 L 93.792150304938 49.833333333333314 L 95.19224211423698 49.833333333333314 L 96.59233392353595 49.833333333333314 L 97.99242573283492 49.833333333333314 L 99.39251754213389 49.833333333333314 L 100.79260935143286 49.833333333333314 L 102.19270116073183 49.833333333333314 L 103.5927929700308 49.833333333333314 L 104.99288477932977 49.833333333333314 L 106.39297658862874 49.833333333333314 L 107.79306839792771 49.833333333333314 L 109.19316020722668 49.833333333333314 L 110.59325201652565 49.833333333333314 L 111.99334382582462 49.833333333333314 L 113.3934356351236 49.833333333333314 L 114.79352744442257 49.833333333333314 L 116.19361925372154 49.833333333333314 L 117.5937110630205 49.833333333333314 L 118.99380287231948 49.833333333333314 L 120.39389468161845 49.833333333333314 L 121.79398649091742 49.833333333333314 L 123.19407830021639 49.833333333333314 L 124.59417010951536 49.833333333333314 L 125.99426191881433 49.833333333333314 L 127.3943537281133 49.833333333333314 L 128.79444553741226 49.833333333333314 L 130.19453734671123 49.833333333333314 L 131.5946291560102 49.833333333333314 L 132.99472096530917 49.833333333333314 L 134.39481277460814 49.833333333333314 L 135.7949045839071 49.833333333333314 L 137.19499639320608 49.833333333333314 L 138.59508820250505 49.833333333333314 L 139.99518001180402 49.833333333333314 L 141.395271821103 49.833333333333314 L 142.79536363040197 49.833333333333314 L 144.19545543970094 49.833333333333314 L 145.5955472489999 49.833333333333314 L 146.99563905829888 49.833333333333314 L 148.39573086759785 49.833333333333314 L 149.79582267689682 49.833333333333314 L 151.1959144861958 49.833333333333314 L 152.59600629549476 49.833333333333314 L 153.99609810479373 49.833333333333314 L 155.3961899140927 49.833333333333314 L 156.79628172339167 49.833333333333314 L 158.19637353269064 49.833333333333314 L 159.5964653419896 49.833333333333314 L 160.99655715128858 49.833333333333314 L 162.39664896058756 49.833333333333314 L 163.79674076988653 49.833333333333314 L 165.1968325791855 49.833333333333314 L 166.59692438848447 49.833333333333314 L 167.99701619778344 49.833333333333314 L 169.3971080070824 49.833333333333314 L 170.79719981638138 49.833333333333314 L 172.19729162568035 49.833333333333314 L 173.59738343497932 49.833333333333314 L 174.9974752442783 49.833333333333314 L 176.39756705357726 49.833333333333314 L 177.79765886287623 49.833333333333314 L 179.1977506721752 49.833333333333314 L 180.59784248147417 49.833333333333314 L 181.99793429077314 49.833333333333314 L 183.39802610007212 49.833333333333314 L 184.7981179093711 49.833333333333314 L 186.19820971867006 49.833333333333314 L 187.59830152796903 49.833333333333314 L 188.998393337268 49.833333333333314 L 190.39848514656697 49.833333333333314 L 191.79857695586594 49.833333333333314 L 193.1986687651649 49.833333333333314 L 194.59876057446388 49.833333333333314 L 195.99885238376285 49.833333333333314 L 197.39894419306182 49.833333333333314 L 198.7990360023608 49.833333333333314 L 200.19912781165976 49.833333333333314 L 201.59921962095873 49.833333333333314 L 202.9993114302577 49.833333333333314 L 204.39940323955668 49.833333333333314 L 205.79949504885565 49.833333333333314 L 207.19958685815462 49.833333333333314 L 208.5996786674536 49.833333333333314 L 209.99977047675256 49.833333333333314 L 211.39986228605153 49.833333333333314 L 212.7999540953505 49.833333333333314 L 214.20004590464947 49.833333333333314 L 215.60013771394844 49.833333333333314 L 217.0002295232474 49.833333333333314 L 218.40032133254638 49.833333333333314 L 219.80041314184535 49.833333333333314 L 221.20050495114432 49.833333333333314 L 222.6005967604433 49.833333333333314 L 224.00068856974227 49.833333333333314 L 225.40078037904124 49.833333333333314 L 226.8008721883402 49.833333333333314 L 228.20096399763918 49.833333333333314 L 229.60105580693815 49.833333333333314 L 231.00114761623712 49.833333333333314 L 232.4012394255361 49.833333333333314 L 233.80133123483506 49.833333333333314 L 235.20142304413403 49.833333333333314 L 236.601514853433 49.833333333333314 L 238.00160666273197 49.833333333333314 L 239.40169847203094 49.833333333333314 L 240.80179028132991 49.833333333333314 L 242.20188209062889 49.833333333333314 L 243.60197389992786 49.833333333333314 L 245.00206570922683 49.833333333333314 L 246.4021575185258 49.833333333333314 L 247.80224932782477 49.833333333333314 L 249.20234113712374 49.833333333333314 L 250.6024329464227 49.833333333333314 L 252.00252475572168 49.833333333333314 L 253.40261656502065 49.833333333333314 L 254.80270837431962 49.833333333333314 L 256.2028001836186 49.833333333333314 L 257.60289199291753 49.833333333333314 L 259.00298380221653 49.833333333333314 L 260.4030756115155 49.833333333333314 L 261.8031674208145 49.833333333333314 L 263.2032592301134 49.833333333333314 L 264.6033510394124 49.833333333333314 L 266.00344284871136 49.833333333333314 L 267.40353465801036 49.833333333333314 L 268.8036264673093 49.833333333333314 L 270.2037182766083 49.833333333333314 L 271.60381008590724 49.833333333333314 L 273.00390189520624 49.833333333333314 L 274.4039937045052 49.833333333333314 L 275.8040855138042 49.833333333333314 L 277.2041773231031 49.833333333333314 L 278.6042691324021 49.833333333333314 L 280.00436094170107 49.833333333333314 L 281.40445275100006 49.833333333333314 L 282.804544560299 49.833333333333314 L 284.204636369598 49.833333333333314 L 285.60472817889695 49.833333333333314 L 287.00481998819595 49.833333333333314 L 288.4049117974949 49.833333333333314 L 289.8050036067939 49.833333333333314 L 291.20509541609283 49.833333333333314 L 292.60518722539183 49.833333333333314 L 294.0052790346908 49.833333333333314 L 295.4053708439898 49.833333333333314 L 296.8054626532887 49.833333333333314 L 298.2055544625877 49.833333333333314 L 299.60564627188666 49.833333333333314 L 301.00573808118565 49.833333333333314 L 302.4058298904846 49.833333333333314 L 303.8059216997836 49.833333333333314 L 305.20601350908254 49.833333333333314 L 306.60610531838154 49.833333333333314 L 308.0061971276805 49.833333333333314 L 309.4062889369794 49.833333333333314 L 310.8063807462784 49.833333333333314 L 312.20647255557736 49.833333333333314 L 313.60656436487636 49.833333333333314 L 315.0066561741753 49.833333333333314 L 316.4067479834743 49.833333333333314 L 317.80683979277325 49.833333333333314 L 319.20693160207225 49.833333333333314 L 320.6070234113712 49.833333333333314 L 322.0071152206702 49.833333333333314 L 323.40720702996913 49.833333333333314 L 324.8072988392681 49.833333333333314 L 326.20739064856707 49.833333333333314 L 327.60748245786607 49.833333333333314 L 329.007574267165 49.833333333333314 L 330.407666076464 49.833333333333314 L 331.80775788576295 49.833333333333314 L 333.20784969506195 49.833333333333314 L 334.6079415043609 49.833333333333314 L 336.0080333136599 49.833333333333314 L 337.40812512295884 49.833333333333314 L 338.80821693225784 49.833333333333314 L 340.2083087415568 49.833333333333314 L 341.6084005508558 49.833333333333314 L 343.0084923601547 49.833333333333314 L 344.4085841694537 49.833333333333314 L 345.80867597875266 49.833333333333314 L 347.20876778805166 49.833333333333314 L 348.6088595973506 49.833333333333314 L 350.0089514066496 49.833333333333314 L 351.40904321594854 49.833333333333314 L 352.80913502524754 49.833333333333314 L 354.2092268345465 49.833333333333314 L 355.6093186438455 49.833333333333314 L 357.0094104531444 49.833333333333314 L 358.4095022624434 49.833333333333314 L 359.80959407174237 49.833333333333314 L 361.20968588104137 49.833333333333314 L 362.6097776903403 49.833333333333314 L 364.0098694996393 49.833333333333314 L 365.40996130893825 49.833333333333314 L 366.81005311823725 49.833333333333314 L 368.2101449275362 49.833333333333314 L 369.6102367368352 49.833333333333314 L 371.01032854613413 49.833333333333314 L 372.41042035543313 49.833333333333314 L 373.8105121647321 49.833333333333314 L 375.2106039740311 49.833333333333314 L 376.61069578333 49.833333333333314 L 378.010787592629 49.833333333333314 L 379.41087940192796 49.833333333333314 L 380.81097121122696 49.833333333333314 L 382.2110630205259 49.833333333333314 L 383.6111548298249 49.833333333333314 L 385.01124663912384 49.833333333333314 L 386.41133844842284 49.833333333333314 L 387.8114302577218 49.833333333333314 L 389.2115220670208 49.833333333333314 L 390.6116138763197 49.833333333333314 L 392.0117056856187 49.833333333333314 L 393.41179749491766 49.833333333333314 L 394.81188930421666 49.833333333333314 L 396.2119811135156 49.833333333333314 L 397.6120729228146 49.833333333333314 L 399.01216473211355 49.833333333333314 L 400.4122565414125 49.833333333333314 L 401.8123483507115 49.833333333333314 L 403.21244016001043 49.833333333333314 L 404.61253196930943 49.833333333333314 L 406.0126237786084 49.833333333333314 L 407.41271558790737 49.833333333333314 L 408.8128073972063 49.833333333333314 L 410.2128992065053 49.833333333333314 L 411.61299101580425 49.833333333333314 L 413.01308282510325 49.833333333333314 L 414.4131746344022 49.833333333333314 L 415.8132664437012 49.833333333333314 L 417.21335825300014 49.833333333333314 L 418.61345006229914 49.833333333333314 L 420.0135418715981 49.833333333333314 L 421.4136336808971 49.833333333333314 L 422.813725490196 49.833333333333314 L 432.813725490196 49.833333333333314" stroke-linejoin="round" visibility="visible" stroke="rgba(192,192,192,0.0001)" stroke-width="22" class=" highcharts-tracker" style=""></path></g><g class="highcharts-markers highcharts-series-0 highcharts-tracker" transform="translate(70,46) scale(1 1)" clip-path="url(#highcharts-6)" style=""><path fill="#7cb5ec" d="M 11 43.833333333333314 C 18.992 43.833333333333314 18.992 55.833333333333314 11 55.833333333333314 C 3.008 55.833333333333314 3.008 43.833333333333314 11 43.833333333333314 Z" stroke="#FFFFFF" stroke-width="1" visibility="hidden"></path></g></g><text x="285" text-anchor="middle" class="highcharts-title" style="color:#333333;font-size:18px;fill:#333333;width:546px;" y="24"><tspan>E-Value Distribution</tspan></text><g class="highcharts-legend" transform="translate(509,185)"><g><g><g class="highcharts-legend-item" transform="translate(8,3)"><path fill="none" d="M 0 11 L 16 11" stroke="#7cb5ec" stroke-width="2"></path><path fill="#7cb5ec" d="M 8 7 C 13.328 7 13.328 15 8 15 C 2.6719999999999997 15 2.6719999999999997 7 8 7 Z"></path><text x="21" style="color:#333333;font-size:12px;font-weight:bold;cursor:pointer;fill:#333333;" text-anchor="start" y="15"><tspan>No. HSPs</tspan></text></g></g></g></g><g class="highcharts-axis-labels highcharts-xaxis-labels"><text x="74.18627450980392" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" text-anchor="middle" transform="translate(0,0)" y="364" opacity="1">0</text><text x="144.19086497475246" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" text-anchor="middle" transform="translate(0,0)" y="364" opacity="1">50</text><text x="214.19545543970094" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" text-anchor="middle" transform="translate(0,0)" y="364" opacity="1">100</text><text x="284.20004590464947" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" text-anchor="middle" transform="translate(0,0)" y="364" opacity="1">150</text><text x="354.204636369598" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" text-anchor="middle" transform="translate(0,0)" y="364" opacity="1">200</text><text x="424.2092268345465" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" text-anchor="middle" transform="translate(0,0)" y="364" opacity="1">250</text><text x="494.213817299495" style="color:#606060;cursor:default;font-size:11px;fill:#606060;" text-anchor="middle" transform="translate(0,0)" y="364" opacity="1">300</text></g><g class="highcharts-axis-labels highcharts-yaxis-labels"><text x="55" style="color:#606060;cursor:default;font-size:11px;fill:#606060;width:191px;text-overflow:clip;" text-anchor="end" transform="translate(0,0)" y="350" opacity="1">4.75</text><text x="55" style="color:#606060;cursor:default;font-size:11px;fill:#606060;width:191px;text-overflow:clip;" text-anchor="end" transform="translate(0,0)" y="300" opacity="1">5</text><text x="55" style="color:#606060;cursor:default;font-size:11px;fill:#606060;width:191px;text-overflow:clip;" text-anchor="end" transform="translate(0,0)" y="250" opacity="1">5.25</text><text x="55" style="color:#606060;cursor:default;font-size:11px;fill:#606060;width:191px;text-overflow:clip;" text-anchor="end" transform="translate(0,0)" y="200" opacity="1">5.5</text><text x="55" style="color:#606060;cursor:default;font-size:11px;fill:#606060;width:191px;text-overflow:clip;" text-anchor="end" transform="translate(0,0)" y="150" opacity="1">5.75</text><text x="55" style="color:#606060;cursor:default;font-size:11px;fill:#606060;width:191px;text-overflow:clip;" text-anchor="end" transform="translate(0,0)" y="100" opacity="1">6</text><text x="55" style="color:#606060;cursor:default;font-size:11px;fill:#606060;width:191px;text-overflow:clip;" text-anchor="end" transform="translate(0,0)" y="51" opacity="1">6.25</text></g><g class="highcharts-tooltip" style="cursor:default;padding:0;pointer-events:none;white-space:nowrap;" transform="translate(35,-9999)" opacity="0" visibility="visible"><path fill="none" d="M 3.5 0.5 L 89.5 0.5 C 92.5 0.5 92.5 0.5 92.5 3.5 L 92.5 41.5 C 92.5 44.5 92.5 44.5 89.5 44.5 L 51.5 44.5 45.5 50.5 39.5 44.5 3.5 44.5 C 0.5 44.5 0.5 44.5 0.5 41.5 L 0.5 3.5 C 0.5 0.5 0.5 0.5 3.5 0.5" isShadow="true" stroke="black" stroke-opacity="0.049999999999999996" stroke-width="5" transform="translate(1, 1)"></path><path fill="none" d="M 3.5 0.5 L 89.5 0.5 C 92.5 0.5 92.5 0.5 92.5 3.5 L 92.5 41.5 C 92.5 44.5 92.5 44.5 89.5 44.5 L 51.5 44.5 45.5 50.5 39.5 44.5 3.5 44.5 C 0.5 44.5 0.5 44.5 0.5 41.5 L 0.5 3.5 C 0.5 0.5 0.5 0.5 3.5 0.5" isShadow="true" stroke="black" stroke-opacity="0.09999999999999999" stroke-width="3" transform="translate(1, 1)"></path><path fill="none" d="M 3.5 0.5 L 89.5 0.5 C 92.5 0.5 92.5 0.5 92.5 3.5 L 92.5 41.5 C 92.5 44.5 92.5 44.5 89.5 44.5 L 51.5 44.5 45.5 50.5 39.5 44.5 3.5 44.5 C 0.5 44.5 0.5 44.5 0.5 41.5 L 0.5 3.5 C 0.5 0.5 0.5 0.5 3.5 0.5" isShadow="true" stroke="black" stroke-opacity="0.15" stroke-width="1" transform="translate(1, 1)"></path><path fill="rgba(249, 249, 249, .85)" d="M 3.5 0.5 L 89.5 0.5 C 92.5 0.5 92.5 0.5 92.5 3.5 L 92.5 41.5 C 92.5 44.5 92.5 44.5 89.5 44.5 L 51.5 44.5 45.5 50.5 39.5 44.5 3.5 44.5 C 0.5 44.5 0.5 44.5 0.5 41.5 L 0.5 3.5 C 0.5 0.5 0.5 0.5 3.5 0.5" stroke="#7cb5ec" stroke-width="1"></path><text x="8" style="font-size:12px;color:#333333;fill:#333333;" y="20"><tspan style="font-size: 10px">5</tspan><tspan style="fill:#7cb5ec" x="8" dy="15">●</tspan><tspan dx="0"> No. HSPs: </tspan><tspan style="font-weight:bold" dx="0">6</tspan></text></g><text x="600" text-anchor="end" style="cursor:pointer;color:#909090;font-size:9px;fill:#909090;" y="395">Highcharts.com</text></svg></div></div>

            </div>


    </div>


<textarea id="outputarea" style="height: 1px; position: relative; top: -10000px; left: -10000px;"></textarea>

<script src="@routes.Assets.at("scripts/validation.js")"></script>
<script>
        $("#tool-tabs").tabs();

           hideTools("");
        var inputFasta = ">gi|33300828|ref|NP_877456#7 putative ATP-dependent DNA ligase [Bacteriophage phiKMV]\nPEITVDGRIVGYVMGKTG-KNVGRVVGYRVELEDGSTVAATGLSEEHIQLLTCAYLNAHI\nD---EAMPNYGRIVEVSAMERSAN-TLRHPSFSRFR\n>gi|114796395|emb|CAK25951#9 putative ATP-dependent DNA ligase [Bacteriophage LKD16]\nPSLAVEGIVVGFVMGKTG-ANVGKVVGYRVDLEDGTIVSATGLTRDRIEMLTTEAELLGG\nA-DHPGMADLGRVVEVTAMERSAN-TLRHPKFSRFR\n>gi|114796457|emb|CAK24995#5 putative DNA ligase [Bacteriophage LKA1]   E=4e-40 s/c=1.7\nPGFEADGTVIDYVWGDPDKANANKIVGFRVRLEDGAEVNATGLTQDQMACYTQSYHATAY\nEVGITQTIYIGRACRVSGMERTKDGSIRHPHFDGFR\n>gi|29366706|ref|NP_813751#8 putative DNA ligase [Pseudomonas phage gh-1]   gi|29243565\nPDDNEDGFIQDVIWGTKGLANEGKVIGFKVLLESGHVVNACKISRALMDEFTDTETRLPG\n-------YYKGHTAKVTFMERYPDGSLRHPSFDSFR\n>gi|68299729|ref|YP_249578#6 DNA ligase [Vibriophage VP4]   gi|66473268|gb|AAY46277.1|\nPEGEIDGTVVGVNWGTVGLANEGKVIGFQVLLENGVVVDANGITQEQMEEYTNLVYKTGH\nD-----DCFNGRPVQVKYMEKTPKGSLRHPSFQRWR\n>gi|77118174|ref|YP_338096#3 ligase [Enterobacteria phage K1F]   gi|72527918|gb|AAZ7297\nPSEEADGHVVRPVWGTEGLANEGMVIGFDVMLENGMEVSATNISRALMSEFTENVKSDP-\n------DYYKGWACQITYMEETPDGSLRHPSFDQWR\n>gi|17570796|ref|NP_523305#4 DNA ligase [Bacteriophage T3]   gi|118769|sp|P07717|DNLI_B\nPECEADGIIQGVNWGTEGLANEGKVIGFSVLLETGRLVDANNISRALMDEFTSNVKAHGE\nD------FYNGWACQVNYMEATPDGSLRHPSFEKFR\n>gi|119637753|ref|YP_91898#2 DNA ligase [Yersinia phage Berlin]   gi|119391784|emb|CAJ\nPECEADGIIQSVNWGTPGLSNEGLVIGFNVLLETGRHVAANNISQTLMEELTANAKEHGE\nD------YYNGWACQVAYMEETSDGSLRHPSFVMFR\n";
        // document.getElementById("alignment").value = inputFasta;
        var inputClustal = "CLUSTAL multiple sequence alignment\n\ngi|33300828\tPEITVDGRIVGYVMGKTG-KNVGRVVGYRVELEDGSTVAATGLSEEHIQLLTCAYLNAHI\ngi|11479639\tPSLAVEGIVVGFVMGKTG-ANVGKVVGYRVDLEDGTIVSATGLTRDRIEMLTTEAELLGG\ngi|11479645\tPGFEADGTVIDYVWGDPDKANANKIVGFRVRLEDGAEVNATGLTQDQMACYTQSYHATAY\ngi|29366706\tPDDNEDGFIQDVIWGTKGLANEGKVIGFKVLLESGHVVNACKISRALMDEFTDTETRLPG\ngi|68299729\tPEGEIDGTVVGVNWGTVGLANEGKVIGFQVLLENGVVVDANGITQEQMEEYTNLVYKTGH\ngi|77118174\tPSEEADGHVVRPVWGTEGLANEGMVIGFDVMLENGMEVSATNISRALMSEFTENVKSDP-\ngi|17570796\tPECEADGIIQGVNWGTEGLANEGKVIGFSVLLETGRLVDANNISRALMDEFTSNVKAHGE\ngi|11963775\tPECEADGIIQSVNWGTPGLSNEGLVIGFNVLLETGRHVAANNISQTLMEELTANAKEHGE\n\ngi|33300828\tD---EAMPNYGRIVEVSAMERSAN-TLRHPSFSRFR\ngi|11479639\tA-DHPGMADLGRVVEVTAMERSAN-TLRHPKFSRFR\ngi|11479645\tEVGITQTIYIGRACRVSGMERTKDGSIRHPHFDGFR\ngi|29366706\t-------YYKGHTAKVTFMERYPDGSLRHPSFDSFR\ngi|68299729\tD-----DCFNGRPVQVKYMEKTPKGSLRHPSFQRWR\ngi|77118174\t------DYYKGWACQITYMEETPDGSLRHPSFDQWR\ngi|17570796\tD------FYNGWACQVNYMEATPDGSLRHPSFEKFR\ngi|11963775\tD------YYNGWACQVAYMEETSDGSLRHPSFVMFR";



        var myCodeMirror = CodeMirror(document.getElementById("inputMirror"), {
            value: inputFasta,
            lineNumbers: false,
            mode:  "none",
            theme: "reformat"
        });
        myCodeMirror.setSize("100%", 220);


        var myCodeMirror2 = CodeMirror(document.getElementById("outputMirror"), {
            value: "",
            lineNumbers: false,
            readOnly: true,
            mode:  "javascript",
            theme: "reformat"
        });

        myCodeMirror2.setSize("100%", 220);

        if(localStorage.getItem("resultcookie")  != null){
        myCodeMirror.setValue(localStorage.getItem("resultcookie"));
        localStorage.removeItem("resultcookie");
        }


        // on and off handler like in jQuery
        myCodeMirror.on('change',function(cMirror){
            hideFormats(getFormat(myCodeMirror.getValue()));

            // get value right from instance
            if(validateFasta(myCodeMirror.getValue())) {
                document.getElementById('callout').style.display = 'block';

                if (validateAlignment(fasta2json(myCodeMirror.getValue()))) {
                    $(".clustaloption").show();
                    document.getElementById('nonalignedwarning').style.display = 'none';
                }
                else {
                    $(".clustaloption").hide();
                    document.getElementById('nonalignedwarning').style.display = 'inline';
                }

            }

            if(getFormat(myCodeMirror.getValue()) != "") {
                 document.getElementById('callout').style.display = 'block';
                 $('#format').text(getFormat(myCodeMirror.getValue()))
            }

            if(getFormat(myCodeMirror.getValue()) == "") {
                 document.getElementById('callout').style.display = 'none';
            }


        });


        document.getElementById("outformat").onchange = function() {
            var currentVal = this.value;
             hideTools(currentVal);
                myCodeMirror2.setValue(($('#inputMirror').val(myCodeMirror.getValue())).reformat(currentVal));
                tempCode = myCodeMirror.getValue();
                myCodeMirror.setValue('');
                $(".CodeMirror-line").decodeEffect();
                myCodeMirror.setValue(tempCode);


            document.getElementById('outputarea').value = myCodeMirror2.getValue();
        };


        /* Highchart */

        function getBins() {
        var resultdict = $('#inputMirror').val(myCodeMirror.getValue()).reformat("alphabet");

        var resultArr = resultdict.split ( "" ) ;
        var bins = new Array () ;
        if(resultdict.indexOf('-') > -1){
            for ( var a = 1 ; a <= resultdict.length - 1 ; a ++ ) {

            bins[ a - 1 ] = resultArr[ a ] ;
            }

        } else {

            for ( var a = 0 ; a <= resultdict.length; a ++ ) {

            bins[ a ] = resultArr[ a ] ;

            }

        }
            return bins;
        }

        function getFreqs() {

        var freqs = $('#inputMirror').val(myCodeMirror.getValue()).reformat("freq");
        
        var freqVals = new Array();

            for (var index in freqs) {

                freqVals.push(freqs[index]);

            }

            return freqVals;
        }

        $(function() {
        var width= $("#tool-tabs").width() - 30;
        var chart = new Highcharts.Chart({
            title: {
            text: 'Relative Frequencies of Amino Acids',
            x: -20 //center
            },
            xAxis: {
            title: {
            text: 'Amino Acids'
            },
            categories: getBins()
            },
            yAxis: {
            title: {
            text: 'Relative Frequency'
            },
            plotLines: [{
            value: 0,
            width: 1,
            color: '#808080'
            }]
            },
            tooltip: {
            },
            legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle',
            borderWidth: 0
            },
            chart: {
            renderTo: 'hcontainer',
            width: width
            },
            series: [{
            name: 'Relative Freq.',
            data: getFreqs()
            }],
            credits: {
            enabled: false
            }
        });

        $('#tab-Freqs').click(function() {
            chart.xAxis[0].setCategories(getBins());
            chart.series[0].setData(getFreqs());
        });

        });



        /* Export */

        function downloadResult() {
            if (myCodeMirror2.getValue())
                $('a.download').attr('href', 'data:application/octet-stream;content-disposition:attachment;filename=file.txt;charset=utf-8,' + encodeURIComponent(myCodeMirror2.getValue()));
        }



        /* DropZone */
        var reader;
        var progress = document.querySelector('.percent');

        function handleFileSelect(evt) {
            evt.stopPropagation();
            evt.preventDefault();


            var files = evt.dataTransfer.files; // FileList object.

            // files is a FileList of File objects. List some properties.
            var output = [];
            progress.style.width = '0%';
            progress.textContent = '0%';
            reader = new FileReader();

            for (var i = 0, f; f = files[i]; i++) {
                if (!f.type.match('text/plain')) {
                    output.push('<li><strong>', 'Please drop only plain text files with *.txt as suffix.', '</strong> </li>');
                    continue;
                }


                reader.onerror = errorHandler;
                reader.onprogress = updateProgress;
                reader.onabort = function(e) {
                    alert('File read cancelled');
                };
                reader.onloadstart = function(e) {
                    document.getElementById('progress_bar').className = 'loading';
                };
                reader.onload = function(e) {
                    // Ensure that the progress bar displays 100% at the end.
                    progress.style.width = '100%';
                    progress.textContent = '100%';
                    setTimeout("document.getElementById('progress_bar').className='';", 2000);
                };

                // Read in the image file as a binary string.
                reader.readAsBinaryString(evt.target.files[i]);



                output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
                        f.size, ' bytes, last modified: ',
                        f.lastModifiedDate.toLocaleDateString(), '</li>');

            }

            document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
        }



        function handleFileSelect2(evt) {
            // Reset progress indicator on new file selection.
            progress.style.width = '0%';
            progress.textContent = '0%';

            reader = new FileReader();

            reader.onerror = errorHandler;
            reader.onprogress = updateProgress;
            reader.onabort = function(e) {
                alert('File read cancelled');
            };
            reader.onloadstart = function(e) {
                document.getElementById('progress_bar').className = 'loading';
            };
            reader.onload = function(e) {
                // Ensure that the progress bar displays 100% at the end.
                progress.style.width = '100%';
                progress.textContent = '100%';
                setTimeout("document.getElementById('progress_bar').className='';", 2000);
                if (evt.target.files[0].type.match('text/plain')) {

                    myCodeMirror.setValue(reader.resultpanel);

                } else alert("type mismatch, please upload only plain text files.");
            };


            // Read in the image file as a binary string.
            //reader.readAsBinaryString(evt.target.files[0]);

            reader.readAsText(evt.target.files[0]);

        }

        function updateProgress(evt) {
            // evt is an ProgressEvent.
            if (evt.lengthComputable) {
                var percentLoaded = Math.round((evt.loaded / evt.total) * 100);
                // Increase the progress bar length.
                if (percentLoaded < 100) {
                    progress.style.width = percentLoaded + '%';
                    progress.textContent = percentLoaded + '%';
                }
            }
        }

        function errorHandler(evt) {
            switch(evt.target.error.code) {
                case evt.target.error.NOT_FOUND_ERR:
                    alert('File Not Found!');
                    break;
                case evt.target.error.NOT_READABLE_ERR:
                    alert('File is not readable');
                    break;
                case evt.target.error.ABORT_ERR:
                    break; // noop
                default:
                    alert('An error occurred reading this file.');
            };
        }

        function abortRead() {
            reader.abort();
        }

        function handleDragOver(evt) {
            evt.stopPropagation();
            evt.preventDefault();
            evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
        }

        // Setup the dnd listeners.
        //var dropZone = document.getElementById('drop_zone');
        //dropZone.addEventListener('dragover', handleDragOver, false);
        //dropZone.addEventListener('drop', handleFileSelect, false);
        document.getElementById('files').addEventListener('change', handleFileSelect2, false);


        // Dropzone Toggle

        $("#dropzonetoggle").on("click", function(){
            if($("#dropzonewrapper").css("display") == "none")
            {
                $("#dropzonewrapper").show();
            } else {
                $("#dropzonewrapper").hide();
            }

            return false;
        });

        /* Paste left */

        function pasteLeft() {

            if (myCodeMirror2.getValue()) {

                myCodeMirror.setValue(myCodeMirror2.getValue());
                myCodeMirror2.setValue("");
            }

            else alert("no output yet");

        }


        /* Decode Effect */


        jQuery.fn.decodeEffect = (function ($) {
            var defaultOptions = {
                duration:      0.001,
                stepsPerGlyph: 1,
                codeGlyphs:    "-ACDEFGHIKLMNPQRSTUVWY",
                className:     "code"
            };

            // get a random string from the given set,
            // or from the 33 - 125 ASCII range
            function randomString(set, length) {
                var string = "", i, glyph;
                for(i = 0 ; i < length ; i++) {
                    glyph = Math.random() * set.length;
                    string += set[glyph | 0];
                }
                return string;
            }

            function animate(element, options) {
                var text = element.text(),
                        span = $("<span/>").addClass(options.className).insertAfter(element),
                        interval = options.duration / (text.length * options.stepsPerGlyph),
                        step = 0,
                        length = 0,
                        stepper = function () {
                            if(++step % options.stepsPerGlyph === 0) {
                                length++;
                                element.text(text.slice(0, length));
                            }
                            if(length <= text.length) {
                                span.text(randomString(options.codeGlyphs, text.length - length));
                                setTimeout(stepper, interval);
                            } else {
                                span.remove();
                            }
                        };
                element.text("");
                stepper();
            }

            // Basic jQuery plugin pattern
            return function (options) {
                options = $.extend({}, defaultOptions, (options || {}));
                return this.each(function () {
                    animate($(this), options);
                });
            };
        }(jQuery));


        /* MSA */

        function initMSA(){

            // this is a way how you use a bundled file parser
            msa = require("msa");

            var opts = {colorscheme: {"scheme": "clustal"}};

            opts.el = document.getElementById("yourDiv");
            opts.vis = {
                conserv: false,
                overviewbox: true,
                seqlogo: true,

                labels: true,
                labelName: true,
                labelId: false,
                labelPartition: false,
                labelCheckbox: false
            };
            opts.conf = {
                dropImport: true
            };
            opts.zoomer = {
                // Alignment viewer is not scrolling with 'alignmentWidth: "auto"', use fixed numbers instead or
                // use script for handling
                alignmentHeight: 525, alignmentWidth: 900, labelNameLength: 165, labelWidth: 85,labelFontsize: "13px",labelIdLength: 75,   menuFontsize: "12px",menuMarginLeft: "2px", menuPadding: "0px 10px 0px 0px", menuItemFontsize: "14px", menuItemLineHeight: "14px", autoResize: true
            };

                opts.seqs = (clustalParser($('#inputMirror').val(myCodeMirror.getValue()).reformat("clustal")));

            // init msa

            var ms = new msa.msa(opts);
            var menuOpts = {};
            menuOpts.el = document.getElementById('div');
            menuOpts.msa = ms;
            var defMenu = new msa.menu.defaultmenu(menuOpts);
            //ms.addView("menu", defMenu);

            // call render at the end to display the whole MSA
            ms.render();

        }



        // hides tools for forwarding that are not able to process the current format
        function hideTools(currentVal) {
                console.log(currentVal)
                var ddl = $('#forwardTool');
                for (var m = 0; m < ddl.length; m++) {
                    for (var i = 0; i < ddl[m].length; i++) {
                         ddl[m].options[i].disabled = false;
                    }
                }
            if (currentVal == 'Genbank') {
                $('#clans').prop('disabled', true);
                $('#csblast').prop('disabled', true);
                $('#hhblits').prop('disabled', true);
                $('#hhpred').prop('disabled', true);
                $('#hmmer3').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#psiblast').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);

            }
            else if (currentVal == 'NEXUS') {
                $('#clans').prop('disabled', true);
                $('#csblast').prop('disabled', true);
                $('#hhblits').prop('disabled', true);
                $('#hhpred').prop('disabled', true);
                $('#hmmer3').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#psiblast').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);
            }
            else if (currentVal == 'EMBL') {
                $('#clans').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);
            }
            else if (currentVal == 'Phylip') {
                $('#clans').prop('disabled', true);
                $('#csblast').prop('disabled', true);
                $('#hhblits').prop('disabled', true);
                $('#hhpred').prop('disabled', true);
                $('#hmmer3').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#psiblast').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);
            }
            else if (currentVal == 'A3M') {
                $('#clans').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);
            }
            else if (currentVal == 'Clustal') {
                $('#clans').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);
            }
            else if (currentVal == 'Fasta') {

            }
            else if (currentVal == 'Stockholm') {
                $('#clans').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);
            }
            else if (currentVal == 'PIR') {
                $('#clans').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);
            }else{
                $('#clans').prop('disabled', true);
                $('#csblast').prop('disabled', true);
                $('#hhblits').prop('disabled', true);
                $('#hhpred').prop('disabled', true);
                $('#hmmer3').prop('disabled', true);
                $('#mafft').prop('disabled', true);
                $('#psiblast').prop('disabled', true);
                $('#tcoffee').prop('disabled', true);
            }
        }

        function hideFormats(currentVal) {

                var ddl = $('#outformat');
                for (var m = 0; m < ddl.length; m++) {
                    for (var i = 0; i < ddl[m].length; i++) {
                         ddl[m].options[i].disabled = false;
                    }
                }
                 switch(currentVal) {
            case "Fasta":
                $('#Fasta').prop('disabled', true);
                break;
            case "A3M":
                $('#A3M').prop('disabled', true);
                break;
            case "Phylip":
                $('#Phylip').prop('disabled', true);
                break;
            case "Clustal":
                $('#Clustal').prop('disabled', true);
                break;
            case "Nexus":
                $('#NEXUS').prop('disabled', true);
                break;
            case "EMBL":
                $('#EMBL').prop('disabled', true);
                break;
            case "Genbank":
                $('#Genbank').prop('disabled', true);
                break;
            case "PIR":
                $('#PIR').prop('disabled', true);
                break;
            case "Stockholm":
                $('#Stockholm').prop('disabled', true);
                break;
            default:
                $('#Fasta').prop('disabled', true);
                $('#A3M').prop('disabled', true);
                $('#Phylip').prop('disabled', true);
                $('#Clustal').prop('disabled', true);
                $('#NEXUS').prop('disabled', true);
                $('#EMBL').prop('disabled', true);
                $('#Genbank').prop('disabled', true);
                $('#PIR').prop('disabled', true);
                $('#Stockholm').prop('disabled', true);
                break;
        }

            }


            /* Forwarding */

            function forward(tool) {
                if(myCodeMirror2.lineCount()>1) {
                var seqs = myCodeMirror2.getValue ( ) ;
                localStorage.setItem ( "resultcookie", seqs ) ;
                window.location.href = "/#/tools/" + tool ;
                } else alert("No output to forward.");
               }


    </script>