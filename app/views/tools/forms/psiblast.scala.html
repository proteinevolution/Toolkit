@import play.api.mvc.RequestHeader
@import models.tools.ToolModel.Psiblast
@import models.tel.TEL
@(tel : TEL, inputForm: Form[(String, String, String, Int, Int, Int, Int, Int, String)])(implicit messages: Messages, request: RequestHeader)

<!-- Order of parameters : Alignment, Alignment_Format, Matrix, Number of Iterations, Evalue, Gap_open, Gap_Ext -->


<script src='@routes.Assets.at("javascripts/sampleseqs.js")' type="text/javascript" ></script>

<script>
        $( function() {
            $( "#tool-tabs" ).tabs();
        } );

        $(".nav-tabs").show();
        document.getElementById("alignment").value = localStorage.getItem("resultcookie");
        localStorage.removeItem("resultcookie");
</script>

<div class="tool-tabs" id="tool-tabs" style="display: none;">
    <ul>
        <li onclick="getIndex(0)" id="tab1"><a href="#tool-tabs-1">Paste Alignment</a></li>
       <!-- <li onclick="getIndex(0)" id="tab2"><a href="#tool-tabs-2">Upload File</a></li> -->
        <li onclick="getIndex(0)" id="tab3"><a href="#tool-tabs-3">Parameter</a></li>
        <span style="float: right; padding: 0.5em 1em 0 0";>PSI-Blast</span>
    </ul>

    <div class="tabs-panel" id="tool-tabs-1">
        @helper.textarea(field = inputForm("alignment"), args = 'rows -> 10, 'cols -> 70,
            '_label -> "",
            'placeholder -> "Enter multiple sequence alignment of single sequence",
            'id -> "alignment", '_showConstraints -> false)
    <div id="past_example">
        <a onClick="$('#alert').prop('hidden',true);$('#submitbutton').prop('disabled', false);$('#alignment').val(alnviz_example());$('#format').val('fas')">Paste example alignment</a>    </div>
    </div>

    <div class="tabs-panel" id="tool-tabs-2">
        <label for="exampleFileUpload" class="button">Upload File</label>
        <input type="file" id="exampleFileUpload" class="show-for-sr">
    </div>
    <div class="tabs-panel" id="tool-tabs-3" align="center">
        <div id="parameters" style="display: flex;">
            <div id="parametersLeft">
                @helper.select(
                    inputForm("alignment_format"),
                    helper.options(Values.fullNames.filterKeys(Psiblast.parameterValues("alignment_format"))),
                    '_label -> "Select alignment format",
                    'id -> "format"
                )

                @helper.select(
                    inputForm("matrix"),
                    helper.options(Values.fullNames.filterKeys(Psiblast.parameterValues("matrix"))),
                    '_label -> "Select Scoring Matrix",
                    'id -> "matrix"
                )
                @helper.inputText(
                    inputForm("num_iter").copy(value=Some("1")),
                    '_label  -> "Set the number of iterations",
                    'id -> "num_iter",
                    '_showConstraints -> false
                )

                @helper.inputText(
                    inputForm("evalue").copy(value=Some("10")),
                    '_label  -> "E-Value",
                    'id -> "evalue",
                    '_showConstraints -> false
                )

            </div>
            <div id="parametersRight">
                @helper.inputText(
                    inputForm("gap_open").copy(value=Some("11")),
                    '_label  -> "Gap Open penalty",
                    'id -> "gap_open",
                    '_showConstraints -> false
                )
                @helper.inputText(
                    inputForm("gap_ext").copy(value=Some("1")),
                    '_label  -> "Gap Extension penalty",
                    'id -> "gap_ext",
                    '_showConstraints -> false
                )
                @helper.inputText(
                    inputForm("desc").copy(value=Some("200")),
                    '_label  -> "Number of alignments and descriptions",
                    'id -> "desc",
                    '_showConstraints -> false
                )

                @helper.select(
                    inputForm("standarddb"),
                    helper.options(tel.getSetParam("standarddb")),
                    '_label -> "Select Database",
                    'id -> "standarddb")
            </div>

        </div>



    </div>



</div>

<div class="callout" id="alert"  hidden>

</div>



<script>
            $('#jobPermission').hide();
            $('#clearJobForm').hide();
            $('#prepareJob').hide();


            $("#continue").click(function () {
                $( "#tool-tabs" ).tabs( "option", "active", $("#tool-tabs").tabs('option', 'active')+1 );
            });

            function getIndex(curIndex) {
                var index = $("#tool-tabs").tabs('option', 'active') + curIndex;
                if(index == 0) {
                    $('.secondary').show();
                    $('#jobPermission').hide();
                    $('#clearJobForm').hide();
                    $('#prepareJob').hide();
                } else if (index == 1) {
                    $('.secondary').show();
                    $('#jobPermission').hide();
                    $('#clearJobForm').hide()
                    $('#prepareJob').hide();
                } else if(index == 2) {
                    $('.secondary').show();
                    $('#jobPermission').hide();
                    $('#clearJobForm').hide()
                    $('#continue').hide()
                    $('#prepareJob').hide();
                }
            }


            $(".jobForm").show();
            $(".tool-tabs").show();

            document.getElementById("alignment").value = localStorage.getItem("resultcookie");
            localStorage.removeItem("resultcookie");





    </script>
