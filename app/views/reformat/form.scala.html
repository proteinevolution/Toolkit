
<style>


    textarea.reformatInput {

        width: 100%;
        height: 220px;
        border: 3px solid #cccccc;
        padding: 5px;
        font-size: 0.625em;


    }

    textarea#reformatOutput {
        width: 100%;
        height: 220px;
        border: 3px solid #cccccc;
        padding: 5px;
        font-size: 0.625em;


    }

    div#content {

        width: 100%;
        background-color: #d1d1d1 !important;
    }

    h6, label {
    padding-left: 50px;
    font-family: 'Noto Sans','Lucida Grande','Lucida Sans Unicode',Geneva,Verdana,Sans-Serif;
    color: #2e2e2e;
    font-weight: bolder;

    }

    .sidebar {

        display: none;
    }




    .CodeMirror pre {

    font-family: Monaco, Consolas, "Lucida Console", monospace;
    font-size: 12px;

    }


</style>

<link href="@routes.Assets.at("styles/reformat.css")" rel="stylesheet">
<div style="padding-top: 10px;"></div>
<h6>Reformat Sequence Converter</h6>

<p>&nbsp;</p>
<!--
<textarea id="alignment" name="alignment" class="reformatInput"></textarea>
<label>Input Format
    <select id="format" name="alignment_format">
        <option value="fas">FASTA</option>
        <option value="clu">CLUSTAL</option>
    </select>
</label>


<div class="callout" id="alert"  hidden>

</div>

<textarea id="reformatOutput" disabled></textarea>
<label>Select Output Format
    <select id="outformat">
        <option value="fas">FASTA</option>
        <option value="a3m">A3M</option>
        <option value="clu">CLUSTAL</option>
        <option value="phy">PHYLIP</option>
        <option value="stock">STOCKHOLM</option>
        <option value="json">JSON</option>
    </select>
</label>
<p>&nbsp;</p>
<p>&nbsp;</p>
<!--<input class="small button" id="submitbutton" value="Convert" onclick="convert()">-->
<div style="width: 95%; display: block; margin: auto;">
<div class="large-6 columns">
<div id="inputMirror" style="width: 100%;"></div>
</div>
<div class="large-6 columns">
<div id="outputMirror" style="width: 100%;"></div>
</div>
</div>
<p>&nbsp;</p>
<div class="success callout" id="fastacallout" data-closable="slide-out-right" style="width: 50%; display: block; margin: auto;">
    <p style="width: 80%; text-align: justify;">It looks as we found a FASTA formatted input. To which format do you want to convert it?</p>
    <button class="close-button" aria-label="Dismiss alert" type="button" data-close>
        <span aria-hidden="true">&times;</span>
    </button>

    <label>Select Output Format
        <select id="outformat">
            <option>Choose</option>
            <option value="a3m">A3M</option>
            <option value="clu">CLUSTAL</option>
        </select>
    </label>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>

<script src="@routes.Assets.at("javascripts/reformat.js")" type="text/javascript"></script>
<script src="@routes.Assets.at("scripts/validation.js")"></script>
<script>

    var inputFasta = ">gi|33300828|ref|NP_877456#7 putative ATP-dependent DNA ligase [Bacteriophage phiKMV]\nPEITVDGRIVGYVMGKTG-KNVGRVVGYRVELEDGSTVAATGLSEEHIQLLTCAYLNAHI\nD---EAMPNYGRIVEVSAMERSAN-TLRHPSFSRFR\n>gi|114796395|emb|CAK25951#9 putative ATP-dependent DNA ligase [Bacteriophage LKD16]\nPSLAVEGIVVGFVMGKTG-ANVGKVVGYRVDLEDGTIVSATGLTRDRIEMLTTEAELLGG\nA-DHPGMADLGRVVEVTAMERSAN-TLRHPKFSRFR\n>gi|114796457|emb|CAK24995#5 putative DNA ligase [Bacteriophage LKA1]   E=4e-40 s/c=1.7\nPGFEADGTVIDYVWGDPDKANANKIVGFRVRLEDGAEVNATGLTQDQMACYTQSYHATAY\nEVGITQTIYIGRACRVSGMERTKDGSIRHPHFDGFR\n>gi|29366706|ref|NP_813751#8 putative DNA ligase [Pseudomonas phage gh-1]   gi|29243565\nPDDNEDGFIQDVIWGTKGLANEGKVIGFKVLLESGHVVNACKISRALMDEFTDTETRLPG\n-------YYKGHTAKVTFMERYPDGSLRHPSFDSFR\n>gi|68299729|ref|YP_249578#6 DNA ligase [Vibriophage VP4]   gi|66473268|gb|AAY46277.1|\nPEGEIDGTVVGVNWGTVGLANEGKVIGFQVLLENGVVVDANGITQEQMEEYTNLVYKTGH\nD-----DCFNGRPVQVKYMEKTPKGSLRHPSFQRWR\n>gi|77118174|ref|YP_338096#3 ligase [Enterobacteria phage K1F]   gi|72527918|gb|AAZ7297\nPSEEADGHVVRPVWGTEGLANEGMVIGFDVMLENGMEVSATNISRALMSEFTENVKSDP-\n------DYYKGWACQITYMEETPDGSLRHPSFDQWR\n>gi|17570796|ref|NP_523305#4 DNA ligase [Bacteriophage T3]   gi|118769|sp|P07717|DNLI_B\nPECEADGIIQGVNWGTEGLANEGKVIGFSVLLETGRLVDANNISRALMDEFTSNVKAHGE\nD------FYNGWACQVNYMEATPDGSLRHPSFEKFR\n>gi|119637753|ref|YP_91898#2 DNA ligase [Yersinia phage Berlin]   gi|119391784|emb|CAJ\nPECEADGIIQSVNWGTPGLSNEGLVIGFNVLLETGRHVAANNISQTLMEELTANAKEHGE\nD------YYNGWACQVAYMEETSDGSLRHPSFVMFR\n";
    // document.getElementById("alignment").value = inputFasta;
    var inputClustal = "CLUSTAL multiple sequence alignment\n\ngi|33300828\tPEITVDGRIVGYVMGKTG-KNVGRVVGYRVELEDGSTVAATGLSEEHIQLLTCAYLNAHI\ngi|11479639\tPSLAVEGIVVGFVMGKTG-ANVGKVVGYRVDLEDGTIVSATGLTRDRIEMLTTEAELLGG\ngi|11479645\tPGFEADGTVIDYVWGDPDKANANKIVGFRVRLEDGAEVNATGLTQDQMACYTQSYHATAY\ngi|29366706\tPDDNEDGFIQDVIWGTKGLANEGKVIGFKVLLESGHVVNACKISRALMDEFTDTETRLPG\ngi|68299729\tPEGEIDGTVVGVNWGTVGLANEGKVIGFQVLLENGVVVDANGITQEQMEEYTNLVYKTGH\ngi|77118174\tPSEEADGHVVRPVWGTEGLANEGMVIGFDVMLENGMEVSATNISRALMSEFTENVKSDP-\ngi|17570796\tPECEADGIIQGVNWGTEGLANEGKVIGFSVLLETGRLVDANNISRALMDEFTSNVKAHGE\ngi|11963775\tPECEADGIIQSVNWGTPGLSNEGLVIGFNVLLETGRHVAANNISQTLMEELTANAKEHGE\n\ngi|33300828\tD---EAMPNYGRIVEVSAMERSAN-TLRHPSFSRFR\ngi|11479639\tA-DHPGMADLGRVVEVTAMERSAN-TLRHPKFSRFR\ngi|11479645\tEVGITQTIYIGRACRVSGMERTKDGSIRHPHFDGFR\ngi|29366706\t-------YYKGHTAKVTFMERYPDGSLRHPSFDSFR\ngi|68299729\tD-----DCFNGRPVQVKYMEKTPKGSLRHPSFQRWR\ngi|77118174\t------DYYKGWACQITYMEETPDGSLRHPSFDQWR\ngi|17570796\tD------FYNGWACQVNYMEATPDGSLRHPSFEKFR\ngi|11963775\tD------YYNGWACQVAYMEETSDGSLRHPSFVMFR";

       /* document.getElementById("format").onchange = function() {

            var currentVal = this.value;


            if (currentVal == "fas") {
                document.getElementById("alignment").value = inputFasta;
            }

            if (currentVal == "clu") {
                document.getElementById("alignment").value = inputClustal;
                document.getElementById("reformatOutput").value = clustal2Fasta(document.getElementById("alignment").value);

            }
        };


        document.getElementById("outformat").onchange = function() {
            var currentVal = this.value;
            var inputVal = document.getElementById("format").value;

            if (currentVal == inputVal) {
                document.getElementById("reformatOutput").value = document.getElementById("alignment").value;
            }

            if (currentVal == "a3m" && inputVal == "fas") {
            document.getElementById("reformatOutput").value = readA3mText(document.getElementById("alignment").value);
            }

            if (currentVal == "clu" && inputVal == "fas") {
                document.getElementById("reformatOutput").value = printClustalText(document.getElementById("alignment").value);
            }

            if (currentVal == "json" && inputVal == "fas") {
                document.getElementById("reformatOutput").value = printAsJSON(document.getElementById("alignment").value);
            }


            if (currentVal == "fas" && inputVal == "clu") {
                document.getElementById("reformatOutput").value = clustal2Fasta(document.getElementById("alignment").value);
            }


            if (currentVal == "json" && inputVal == "clu") {
                document.getElementById("reformatOutput").value = clustalAsJSON(document.getElementById("alignment").value);
            }

            if (currentVal == "a3m" && inputVal == "clu") {
                document.getElementById("reformatOutput").value = readA3mText(clustal2Fasta(document.getElementById("alignment").value));
            }

        } */


    var myCodeMirror = CodeMirror(document.getElementById("inputMirror"), {
    value: inputFasta,
    lineNumbers: false,
    mode:  "none",
    theme: "reformat"
    });

    myCodeMirror.setSize("100%", 500);


    var myCodeMirror2 = CodeMirror(document.getElementById("outputMirror"), {
    value: "",
    lineNumbers: false,
    mode:  "javascript",
    theme: "reformat"
    });

    myCodeMirror2.setSize("100%", 500);




    // on and off handler like in jQuery
    myCodeMirror.on('change',function(cMirror){
        // get value right from instance
        if(validateFasta(myCodeMirror.getValue())) {
            document.getElementById('fastacallout').style.display = 'block';
        } else document.getElementById('fastacallout').style.display = 'none';;
    });


    document.getElementById("outformat").onchange = function() {
        var currentVal = this.value;

        if (currentVal == "a3m") {
            console.log("Hallo");
            myCodeMirror2.setValue(readA3mText(myCodeMirror.getValue()));
        }

        if (currentVal == "clu") {
            myCodeMirror2.setValue(printClustalText(myCodeMirror.getValue()));
        }

    }


</script>

